!function(a){"use strict";if("undefined"!=typeof HOMEY_map_vars){var e,t,n="",i=HOMEY_map_vars.is_mapbox,o=HOMEY_map_vars.api_mapbox,r=HOMEY_map_vars.user_id,s=a("#listings_found"),l=HOMEY_map_vars.admin_url+"admin-ajax.php",m=HOMEY_map_vars.header_map_city,d=HOMEY_map_vars.markerPricePins,c=HOMEY_map_vars.pin_cluster,p=(HOMEY_map_vars.pin_cluster_icon,HOMEY_map_vars.pin_cluster_zoom,HOMEY_map_vars.is_singular_listing),u=HOMEY_map_vars.homey_default_radius,_=(HOMEY_map_vars.geo_country_limit,HOMEY_map_vars.geocomplete_country,0),v=new Array,y=a("#homey_halfmap_listings_container"),g=(HOMEY_map_vars.default_lat,HOMEY_map_vars.default_lng,HOMEY_map_vars.arrive),h=HOMEY_map_vars.depart,f=HOMEY_map_vars.guests,b=HOMEY_map_vars.pets,O=HOMEY_map_vars.search_country,E=HOMEY_map_vars.search_city,M=HOMEY_map_vars.search_area,H=HOMEY_map_vars.listing_type,k=HOMEY_map_vars.country,Y=HOMEY_map_vars.state,w=HOMEY_map_vars.city,x=HOMEY_map_vars.area,z=HOMEY_map_vars.booking_type,j=HOMEY_map_vars.start_time,I=HOMEY_map_vars.end_time,Z=HOMEY_map_vars.min_price,B=HOMEY_map_vars.max_price,T=HOMEY_map_vars.keyword,S=HOMEY_map_vars.lat,A=HOMEY_map_vars.lng,P=HOMEY_map_vars.radius,C=HOMEY_map_vars.bedrooms,D=HOMEY_map_vars.rooms,Q=HOMEY_map_vars.room_size,U=(x=HOMEY_map_vars.area,HOMEY_map_vars.amenity),N=HOMEY_map_vars.facility,W=HOMEY_map_vars.not_found,q=(HOMEY_map_vars.infoboxClose,HOMEY_map_vars.bedrooms_icon),F=HOMEY_map_vars.bathroom_icon,G=HOMEY_map_vars.guests_icon,R=a("#securityhomeyMap").val(),V=0,J=HOMEY_ajax_vars.compare_url,K=HOMEY_ajax_vars.add_compare,X=HOMEY_ajax_vars.remove_compare,$=HOMEY_ajax_vars.compare_limit;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&!0;var aa=function(){if("mapbox"==i&&""!=o)var a=L.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token="+o,{attribution:'© <a href="https://www.mapbox.com/about/maps/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> <strong><a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a></strong>',tileSize:512,maxZoom:18,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"your.mapbox.access.token"});else a=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'});return a},ea=function(){for(var a=0;a<v.length;a++)e.removeLayer(v[a]);v=[],t&&e.removeLayer(t)},ta=function(e){a("#listing-mapzoomin").on("click",function(){var a=parseInt(e.getZoom(),10);console.log(a),++a>20&&(a=20),e.setZoom(a)})},na=function(e){a("#listing-mapzoomout").on("click",function(){var a=parseInt(e.getZoom(),10);console.log(a),--a<0&&(a=0),e.setZoom(a)})};a("#homey-gmap-next").on("click",function(){!function(a){for(++_>v.length&&(_=1);!1===v[_-1].visible;)++_>v.length&&(_=1);a.getZoom()<15&&a.setZoom(15),a.setView(v[_-1].getLatLng()),v[_-1]._icon||v[_-1].__parent.spiderfy(),a.setZoom(20),_-1==0||_-1==v.length?setTimeout(function(){v[_-1].fire("click")},500):v[_-1].fire("click")}(e)}),a("#homey-gmap-prev").on("click",function(){!function(a){for(--_<1&&(_=v.length);!1===v[_-1].visible;)--_>v.length&&(_=1);a.getZoom()<15&&a.setZoom(15),a.setView(v[_-1].getLatLng()),v[_-1]._icon||v[_-1].__parent.spiderfy(),a.setZoom(20),_-1==0||_==v.length?setTimeout(function(){v[_-1].fire("click")},500):v[_-1].fire("click")}(e)});var ia=function(a,e){var n,i=function(a){for(var e=[],t=0;t<a.length;t++)a[t].lat&&a[t].long&&e.push([a[t].lat,a[t].long]);return e}(a);1<=i.length&&e.fitBounds(i),"yes"==c&&(t=new L.MarkerClusterGroup({iconCreateFunction:function(a){var e='<div class="homey-osm-cluster">'+a.getAllChildMarkers().length+"</div>";return L.divIcon({html:e,className:"mycluster",iconSize:L.point(47,47)})},spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0}));for(var o=0;o<a.length;o++)if(a[o].lat&&a[o].long){var r=a[o],s=L.latLng(r.lat,r.long),l={riseOnHover:!0};if(r.title&&(l.title=r.title),"yes"==d){var m='<div  id="infobox_popup_'+a[o].id+'"  data-id="'+a[o].id+'" class="gm-marker gm-marker-color-'+a[o].term_id+'"><div class="gm-marker-price">'+a[o].price+"</div></div>",p=L.divIcon({className:"someclass",iconSize:new L.Point(0,0),html:m});n="yes"==c?new L.Marker(s,{icon:p}):L.marker(s,{icon:p}).addTo(e)}else{var u=a[o].icon,_=a[o].retinaIcon;if(u){var y={iconUrl:u,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]};_&&(y.iconRetinaUrl=_),l.icon=L.icon(y)}n="yes"==c?new L.Marker(s,l):L.marker(s,l).addTo(e)}"yes"==c&&t.addLayer(n);var g="",h="",f="",b="";""!=a[o].bedrooms&&(g="<li>"+q+'<span class="total-beds">'+a[o].bedrooms+"</span></li>"),""!=a[o].baths&&(h="<li>"+F+'<span class="total-baths">'+a[o].baths+"</span></li>"),""!=a[o].guests&&(f="<li>"+G+'<span class="total-guests">'+a[o].guests+"</span></li>"),""!=a[o].listing_type&&(b='<li class="item-type">'+a[o].listing_type+"</li>");var O='<div id="google-maps-info-window" class="homey-open-street-map"><div class="item-wrap item-grid-view"><div class="media property-item"><div class="media-left"><div class="item-media item-media-thumb"><a href="'+a[o].url+'" class="hover-effect">'+a[o].thumbnail+'</a><div class="item-media-price"><span class="item-price">'+a[o].price+'</span></div></div></div><div class="media-body item-body clearfix"><div class="item-title-head"><div class="title-head-left"><h2 class="title"><a href="'+a[o].url+'">'+r.title+'</a></h2><address class="item-address">'+a[o].address+'</address></div></div><ul class="item-amenities">'+g+h+f+b+"</ul></div></div></div></div>";v.push(n),n.bindPopup(O)}"yes"==c&&e.addLayer(t)},oa=function(e,t,n,i,o,r,s,l,m,d){var c=a("#homey-halfmap");g=e.find('input[name="arrive"]').val(),h=e.find('input[name="depart"]').val(),f=e.find('input[name="guest"]').val(),T=e.find('input[name="keyword"]').val(),b=e.find('input[name="pets"]:checked').val(),M=e.find('input[name="search_area"]').val(),E=e.find('input[name="search_city"]').val(),O=e.find('input[name="search_country"]').val(),S=e.find('input[name="lat"]').val(),A=e.find('input[name="lng"]').val(),P=e.find('input[name="radius"]').val(),z=e.find('input[name="booking_type"]').val(),H=e.find('select[name="listing_type"]').val(),k=e.find('select[name="country"]').val(),Y=e.find('select[name="state"]').val(),w=e.find('select[name="city"]').val(),x=e.find('select[name="area"]').val(),j=e.find('select[name="start"]').val(),I=e.find('select[name="end"]').val(),""!=H&&null!=H||(H=c.data("type")),""!=z&&null!=z||(z=c.data("booking_type")),U=e.find(".amenities-list input[type=checkbox]:checked").map(function(e,t){return a(t).val()}).toArray(),N=e.find(".facilities-list input[type=checkbox]:checked").map(function(e,t){return a(t).val()}).toArray(),Z=e.find('select[name="min-price"]').val(),B=e.find('select[name="max-price"]').val(),C=e.find('select[name="bedrooms"]').val(),D=e.find('select[name="rooms"]').val(),Q=e.find('select[name="room_size"]').val();var p=a("#sort_listings_halfmap").val();null!=t&&(V=t);ra(n,i,o,r,s,l,m,d,{action:"homey_half_map",arrive:g,depart:h,guest:f,keyword:T,pets:b,bedrooms:C,rooms:D,room_size:Q,search_country:O,search_city:E,search_area:M,listing_type:H,"min-price":Z,"max-price":B,country:k,search_lat:S,search_lng:A,radius:P,state:Y,city:w,area:x,booking_type:z,start_hour:j,end_hour:I,amenity:U,facility:N,sort_by:p,layout:Ma,num_posts:La,paged:t,security:R},"")},ra=function(t,n,i,o,d,c,u,_,v,g){if(null!=document.getElementById(i)){if(c||(c=14),!u)u=0;var h,f="";_?h="homey_half_map":(h="homey_header_map","lat_long"==g||"city"==g&&(f=m));var b={dragging:!0,center:L.latLng(t,n),zoom:10,tap:!0},O=L.DomUtil.get(i);if(null!=O&&(O._leaflet_id=null),(e=L.map(i,b)).scrollWheelZoom.disable(),e.addLayer(aa()),_)var E=v;else E={action:h,map_cities:f,security:R};var M=function(t,n){void 0!==n&&a.ajax({url:t,dataType:"json",method:"POST",data:n,beforeSend:function(){a("#homey-map-loading").show(),_&&y.empty().append('<div id="homey-map-loading"><div class="mapPlaceholder"><div class="loader-ripple spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div></div>')},success:function(n){var i;!0===n.getListings?(ea(),ia(n.listings,e),_&&(y.empty().html(n.listingHtml),s.empty().html(n.total_results),xa()),homey_init_add_favorite(t,r,p),homey_init_remove_favorite(t,r,p),i=homeyGetCookie("homey_compare_listings"),add_to_compare(J,K,X,$,i,4),remove_from_compare(i,K,X),_&&(Ya(),a(".half-map-left-wrap, .half-map-right-wrap").animate({scrollTop:0},"slow")),a("#homey-map-loading").hide()):(ea(),a("#homey-halfmap").append('<div class="map-notfound">'+W+"</div>"),y.empty().html('<div class="map-notfound">'+W+"</div>"),s.empty().html(n.total_results),a(".loader-ripple").hide())},error:function(a){console.log(a)}})};M(l,E),document.getElementById("listing-mapzoomin")&&ta(e),document.getElementById("listing-mapzoomout")&&na(e);var H=setInterval(function(){void 0!==a("#homey-gmap-prev")&&M(),clearInterval(H)},1500)}else console.log("No map element found")};if(a("#banner-map").length>0){var sa=(va=a("#banner-map")).data("zoomlevel"),la=va.data("maptype");va.data("lat"),va.data("long");ra(pa="",ua="",ya="banner-map",ba="infobox",ha=!0,ga=sa,Ea=0,Oa=!1,null,la)}if(a("#homey-single-map").length>0){sa=(va=a("#homey-single-map")).data("zoom");var ma=va.data("pin-type"),da=va.data("marker-pin"),ca=va.data("marker-pin-retina"),pa=va.data("lat"),ua=va.data("long");if("marker"==ma)var _a=!1;else _a=!0;!function(a,t,n,i,o,r,s,l){i||(i=!1),o||(o=!1),r||(r=15);var m,d={riseOnHover:!0},c=function(a){if(s){var e={iconUrl:s,iconSize:[44,56],iconAnchor:[20,57],popupAnchor:[1,-57]};l&&(e.iconRetinaUrl=l),d.icon=L.icon(e)}L.marker(m,d).addTo(a)},p=function(a){L.circle(m,200).addTo(a)};!function(a){var t={dragging:i,center:a,zoom:r,tap:!1},s=document.getElementById(n);(e=L.map(s,t)).scrollWheelZoom.disable(),e.addLayer(aa()),o||c(e),o&&p(e)}(m=L.latLng(a,t))}(pa,ua,ya="homey-single-map",!1,_a,ga=sa,da,ca)}if(a("#homey_sticky_map").length>0){var va=a("#homey_sticky_map"),ya="homey_sticky_map",ga=12,ha=!0,fa=va.data("mappaged");!function(t,n,i,o){if(null!=document.getElementById(t)){i||(i=14);var r={dragging:!0,center:L.latLng("",""),zoom:10,tap:!0},s=L.DomUtil.get(t);null!=s&&(s._leaflet_id=null),(e=L.map(t,r)).scrollWheelZoom.disable(),e.addLayer(aa()),!function(t,n){a.ajax({url:t,dataType:"json",method:"POST",data:n,success:function(t){!0===t.getListings&&(ea(),ia(t.listings,e),a("#homey-map-loading").hide())},error:function(a){console.log(a)}})}(l,{action:"homey_sticky_map",paged:o,security:R}),document.getElementById("listing-mapzoomin")&&ta(e),document.getElementById("listing-mapzoomout")&&na(e)}else console.log("No map element found")}(ya,0,ga,fa)}if(a("#homey-halfmap").length>0){sa=(va=a("#homey-halfmap")).data("zoom");var ba,Oa,Ea,Ma=va.data("layout"),La=va.data("num-posts"),Ha=va.data("order"),ka=va.data("type");z=va.data("booking_type");""==H&&(H=ka),ra(pa="",ua="",ya="homey-halfmap",ba="infobox",ha=!0,ga=sa,Ea=0,Oa=!0,{action:"homey_half_map",arrive:g,depart:h,guest:f,keyword:T,pets:b,bedrooms:C,rooms:D,room_size:Q,search_country:O,search_city:E,search_area:M,listing_type:H,"min-price":Z,"max-price":B,country:k,state:Y,city:w,area:x,booking_type:z,search_lat:S,search_lng:A,radius:P,start_hour:j,end_hour:I,amenity:U,facility:N,layout:Ma,num_posts:La,sort_by:Ha,paged:V,security:R},la=""),a(".homey_half_map_search_btn").on("click",function(e){e.preventDefault();var t=a(this).parents(".half-map-wrap");oa(t,1,pa,ua,ya,ba,ha,ga,Ea,Oa)}),a("#sort_listings_halfmap").on("change",function(e){e.preventDefault();var t=a(this).parents(".half-map-wrap");oa(t,1,pa,ua,ya,ba,ha,ga,Ea,Oa)});var Ya=function(){return a(".half_map_ajax_pagi a").on("click",function(e){e.preventDefault();var t=a(this).data("homeypagi"),n=a(this).parents(".half-map-wrap");oa(n,t,pa,ua,ya,ba,ha,ga,Ea,Oa)}),!1};a("#radius-range-slider").length>0&&(za=u,a("#radius-range-slider").slider({value:za,min:0,max:100,step:1,slide:function(e,t){a("#radius-range-text").html(t.value),a("#radius-range-value").val(t.value)},stop:function(e,t){var n=a(this).parents(".half-map-wrap");oa(n,1,pa,ua,ya,ba,ha,ga,Ea,Oa)}}),a("#radius-range-text").html(a("#radius-range-slider").slider("value")),a("#radius-range-value").val(a("#radius-range-slider").slider("value")))}a("input.input-search").length>0&&jQuery("input.input-search").autocomplete({source:function(a,e){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:a.term},function(a){a.length?e(a.map(function(a){var e={label:a.display_name,latitude:a.lat,longitude:a.lon,value:a.display_name};return void 0!==a.address&&(e.county=a.address.county),void 0!==a.address&&(e.city=a.address.city),void 0!==a.address&&(e.state=a.address.state),void 0!==a.address&&(e.country=a.address.country),void 0!==a.address&&(e.zip=a.address.postcode),void 0!==a.address&&(e.country_short=a.address.country_code),e})):e([{value:"",label:"there are no results"}])},"json")},select:function(e,t){a('input[name="lat"]').val(t.item.latitude),a('input[name="lng"]').val(t.item.longitude),a('input[name="search_area"]').attr("data-value",""),a('input[name="search_area"]').val(""),a('input[name="search_city"]').attr("data-value",t.item.city),a('input[name="search_city"]').val(t.item.city),a('input[name="search_country"]').attr("data-value",t.item.country),a('input[name="search_country"]').val(t.item.country)}});!function(){if(0!==jQuery("#map").length){var t=a("#map"),i=t.data("add-lat"),o=t.data("add-long");""!==i&&void 0!==i||(i=25.68654),""!==o&&void 0!==o||(o=-80.431345),i=parseFloat(i),o=parseFloat(o);var r=L.latLng(i,o);(e=L.map("map",{center:r,zoom:15})).scrollWheelZoom.disable();var s=aa();e.addLayer(s),(n=L.marker(r,{riseOnHover:!0,draggable:!0}).addTo(e)).on("drag",function(a){document.getElementById("lat").value=n.getLatLng().lat,document.getElementById("lng").value=n.getLatLng().lng})}}();var wa=function(a,t){var i=L.latLng(a,t);n.setLatLng(i),e.invalidateSize(),e.panTo(new L.LatLng(a,t)),document.getElementById("lat").value=a,document.getElementById("lng").value=t};a("#find").on("click",function(e){event.preventDefault();var t=a("#listing_address").val().replace(/\n/g,",").replace(/,,/g,",");t&&a.get("https://nominatim.openstreetmap.org/search",{format:"json",q:t,limit:1},function(a){1===a.length&&wa(a[0].lat,a[0].lon)},"json")});jQuery("#listing_address").autocomplete({source:function(a,e){jQuery.get("https://nominatim.openstreetmap.org/search",{format:"json",q:a.term,addressdetails:"1"},function(a){a.length?e(a.map(function(a){var e={label:a.display_name,latitude:a.lat,longitude:a.lon,value:a.display_name};return void 0!==a.address&&(e.county=a.address.county),void 0!==a.address&&(e.city=a.address.city),void 0!==a.address&&(e.state=a.address.state),void 0!==a.address&&(e.country=a.address.country),void 0!==a.address&&(e.zip=a.address.postcode),void 0!==a.address&&(e.country_short=a.address.country_code),e})):e([{value:"",label:"there are no results"}])},"json")},select:function(e,t){var n=t.item.latitude,i=t.item.longitude;a("#zip").val(t.item.zip),a("#countyState").val(t.item.county),a("#city").val(t.item.city),a("#homey_country").val(t.item.country),a('input[name="country_short"]').val(t.item.country_short),wa(n,i),a("#city, #countyState, #area, #homey_country").selectpicker("refresh")}});var xa=function(){return a(".infobox_trigger").each(function(e){a(this).on("mouseenter",function(){v[e].fire("click")}),a(this).on("mouseleave",function(){})}),!1}}var za}(jQuery);